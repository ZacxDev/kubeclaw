# -- Agent name. Used for resource naming, namespace suffix, and config defaults.
# @required
agentName: ""

# -- Human-readable display name for the agent in Matrix/config.
# Defaults to "{agentName} Dev" if empty.
agentDisplayName: ""

image:
  # -- Container image repository
  repository: your-registry/openclaw
  # -- Container image tag
  tag: latest
  # -- Image pull policy
  pullPolicy: Always

# -- Image pull secrets
imagePullSecrets: []

# -- Git configuration for repo cloning
git:
  # -- Git user email for commits
  email: "agent@devpod.local"
  # -- Git user name for commits
  name: "DevPod Agent"
  # -- Repositories to clone at startup
  # Each entry: { url, path, branch }
  repos: []
  # - url: "git@github.com:user/repo.git"
  #   path: "/data/repos/repo"
  #   branch: "main"

# -- Agent configuration for openclaw.json
agent:
  # -- Agent ID. Defaults to agentName if empty.
  id: ""
  # -- Workspace directory. Defaults to first repo path or /data/workspace.
  workspace: ""
  # -- Maximum concurrent sessions
  maxConcurrent: 4
  model:
    # -- Primary Claude model
    primary: "anthropic/claude-sonnet-4"
  # -- Matrix mention trigger patterns.
  # Defaults to ["@{agentName}", "{agentName}"] if empty.
  mentionPatterns: []

# -- Skill files to mount. Map of filename to content.
skills: {}
# promptver-dev.md: |
#   # Promptver Dev Skill
#   ...

# -- Workspace files to place in the agent's working directory on startup.
# Array of {path, url} objects. Each file is downloaded via curl at startup.
# URLs are typically pre-signed S3 URLs generated by the ClawSail portal.
# Stored as a JSON array in a ConfigMap and downloaded by the startup script.
workspaceFiles: []
# - path: CLAUDE.md
#   url: "http://minio.minio-tenant.svc.cluster.local/clawsail/workspace/abc/CLAUDE.md?X-Amz-..."
# - path: src/config.yaml
#   url: "http://minio.minio-tenant.svc.cluster.local/clawsail/workspace/abc/src/config.yaml?X-Amz-..."

# -- Inline content files to place in the agent's workspace directory on startup.
# Map of relative path to file content. Unlike workspaceFiles (which downloads from URLs),
# this embeds content directly in the Helm values. Ideal for AGENTS.md, CLAUDE.md, etc.
workspaceContent: {}
# AGENTS.md: |
#   # Project Instructions
#   Always use feature branches...
# CLAUDE.md: |
#   # Claude Code Instructions
#   ...

# -- Channel configuration
channels:
  matrix:
    # -- Enable Matrix channel
    enabled: true
    # -- Matrix homeserver URL
    homeserver: "https://matrix.example.com"
    # -- DM policy
    dm:
      policy: "open"
      allowFrom:
        - "*"
    # -- Group chat policy
    groupPolicy: "open"
    # -- Auto-join behavior
    autoJoin: "always"
  telegram:
    # -- Enable Telegram channel
    enabled: false
    # -- Pre-approved Telegram user IDs (skips pairing flow)
    allowFrom: []
  whatsapp:
    # -- DM policy: "pairing" requires QR scan, "open" accepts all
    dmPolicy: "pairing"
    # -- Group chat policy
    groupPolicy: "disabled"
    # -- Send read receipts
    sendReadReceipts: true
  email:
    # -- Enable email channel (Mailpit + CronJob poller)
    enabled: false
    # -- Agent email address (auto-generated by portal)
    address: ""
    # -- Mailpit API URL for the email poller CronJob
    mailpitUrl: ""

# -- Tools configuration
tools:
  web:
    search:
      # -- Enable web search
      enabled: true
      # -- Search provider
      provider: "brave"
      # -- Max search results
      maxResults: 3

# -- Gateway configuration
gateway:
  # -- Gateway mode
  mode: "local"
  # -- Callback URL for the main openclaw gateway (for result posting).
  # Set to the main openclaw service URL if agents need to report back.
  callbackUrl: ""
  # -- HTTP endpoint settings
  http:
    endpoints:
      # -- Enable OpenAI-compatible POST /v1/chat/completions endpoint.
      # Required for ClawSail built-in chat.
      chatCompletions:
        enabled: true

# -- Commands configuration
commands:
  native: "auto"
  nativeSkills: "auto"

# -- Messages configuration
messages:
  ackReactionScope: "all"

# -- Hooks configuration
hooks:
  # -- Enable hooks
  enabled: true
  # -- Hook mappings array. If empty, a default element hook is generated.
  # Set to a non-empty array to fully override.
  mappings: []
  # - match: { path: "element" }
  #   action: "agent"
  #   wakeMode: "now"
  #   name: "Agent Name"
  #   sessionKey: "hook:element:{{timestamp}}"
  #   messageTemplate: "..."
  #   deliver: false

# -- Name of an existing Secret containing agent tokens/keys.
# Expected keys: MATRIX_ACCESS_TOKEN, TELEGRAM_BOT_TOKEN, HOOKS_TOKEN,
#   GITHUB_TOKEN, BRAVE_API_KEY, ANTHROPIC_API_KEY, git-ssh-key,
#   claude-credentials.json (all optional)
existingSecret: ""

# -- Namespace configuration
namespace:
  # -- Create the namespace
  create: true

# -- RBAC configuration
rbac:
  # -- Create RBAC resources (Role, RoleBinding, ServiceAccount)
  create: true
  clusterAdmin:
    # -- Create a ClusterRoleBinding to cluster-admin for this agent
    enabled: false
  orchestrator:
    # -- Create a scoped ClusterRole for cross-namespace agent orchestration.
    # Grants read access to namespaces, pods, pods/log, cronjobs, jobs, and
    # HelmReleases, plus pods/exec create and job create.
    # Skipped when clusterAdmin is enabled (superset).
    enabled: false

# -- Infrastructure tools installation (kubectl, flux, sops, age)
infraTools:
  # -- Install infrastructure tools at startup
  enabled: false
  kubeconfigs:
    # -- Name of existing Secret containing kubeconfig files
    existingSecret: ""

# -- Extra ConfigMaps to create and mount (e.g., agents registry for coordinator)
# Each entry: { name, mountPath, data }
extraConfigMaps: []
# - name: agents-registry
#   mountPath: /config/agents
#   data:
#     agents.json: |
#       { "agents": [...] }

# -- Extra volumes to add to the pod
extraVolumes: []

# -- Extra volume mounts to add to the container
extraVolumeMounts: []

# -- Extra environment variables
extraEnv: []

# -- Extra shell commands to run during container startup, after all standard
# initialization (repo clone, tools install, config generation, auth bootstrap)
# but before the gateway starts. Use for installing project-specific tools.
extraInitCommands: ""

# -- Full openclaw.json override. When set, bypasses all templated config generation.
# The secret fields are still injected via jq at runtime.
rawConfig: {}

# -- Persistence configuration
persistence:
  # -- Enable persistence
  enabled: true
  # -- Use an existing PVC
  existingClaim: ""
  # -- Storage class (empty = cluster default)
  storageClass: ""
  # -- PVC size
  size: 10Gi
  # -- Access modes
  accessModes:
    - ReadWriteOnce

# -- Container resource requests/limits
resources:
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "2Gi"
    cpu: "2000m"

# -- Workflow orchestration image (used by CronJob pods to exec into agent)
workflowImage:
  repository: bitnami/kubectl
  tag: latest

# -- Default settings for all workflows (can be overridden per workflow)
workflowDefaults:
  # -- Per-step timeout in seconds
  timeout: 900
  # -- CronJob concurrency policy
  concurrencyPolicy: Forbid
  # -- Suspend the CronJob
  suspend: false
  # -- Pull git repos before running steps
  gitSync: true
  # -- Number of successful job runs to keep
  successfulJobsHistoryLimit: 3
  # -- Number of failed job runs to keep
  failedJobsHistoryLimit: 3
  # -- Resource requests/limits for workflow CronJob pods
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "200m"

# -- Workflow definitions. Each key creates a CronJob that orchestrates
# sequential agent steps via kubectl exec into the running agent pod.
# See examples/workflow-product-iteration.yaml for a full example.
workflows: {}
# example-workflow:
#   schedule: "0 10 * * *"
#   timeout: 1800
#   agent: ""
#   gitSync: true
#   concurrencyPolicy: Forbid
#   suspend: false
#   context:
#     CUSTOM_VAR: "value"
#   report:
#     path: "reports/{{workflow}}-{{date}}.md"
#     commit: true
#     branch: "trunk"
#     repo: ""
#   notify:
#     telegram:
#       chatId: ""
#     matrix:
#       enabled: false
#   steps:
#     - name: "step-one"
#       skill: |
#         Do something...
#       timeout: 300
#       notify: false

# -- Pod-level settings
nodeSelector: {}
tolerations: []
affinity: {}
